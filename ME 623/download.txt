function [] = drawmesh(coor, conn, ndof, displacements)
% This is a simple function to draw a mesh given the coordinates of the
% nodes and connectivity of the elements. The number of elements and nodes
% in the system is determined from the size of the arrays you provide, so
% you are responsible for the data that is passed to the function. Usage: 
% drawmesh(coor, conn)
% where coor is a nnodeXndim array where nnode=number of nodes and ndim=
% dimension of the problem. ndim can be 1, 2, or 3. ndof is the number of
% dof per node.
% conn is a nelem X nperlm array where nelem is the number of elements and
% nperlm is the number of nodes connected to each element.
% if displacement is provided, it should be a nndoe*ndof X 1 array
% containing the displacement values at every dof.
ndim=size(coor,2);
nperlm=size(conn,2);
nelem=size(conn,1);
nnode=size(coor,1);
if (exist('displacements'))
ndof=size(displacements,1)/nnode;
idof=0;
for i=1:nnode
    for j=1:ndof
        idof=idof+1;
        coor(i,j) = coor(i,j) + displacements(idof);
    end
end    
end
% draw the mesh
hfig=figure;
hold on;
% draw full mesh
startlm=1; endlm=nelem;
startnode=1; endnode=nnode;
for i=startlm:endlm
   xplot=[];
   yplot=[];
   zplot=[];
   if (ndim <= 2)
       for j=1:nperlm
           xplot=[xplot coor(conn(i,j),1)];
           yplot=[yplot coor(conn(i,j),2)];
       end
       xplot=[xplot coor(conn(i,1),1)];
       yplot=[yplot coor(conn(i,1),2)];
       plot(xplot, yplot);
       hold on;
   end
   if (ndim == 3)
       for j=1:nperlm
           xplot=[xplot coor(conn(i,j),1)];
           yplot=[yplot coor(conn(i,j),2)];
           zplot=[zplot coor(conn(i,j),3)];
       end
       xplot=[xplot coor(conn(i,1),1)];
       yplot=[yplot coor(conn(i,1),2)];
       zplot=[zplot coor(conn(i,1),3)];
       plot(xplot, yplot);
       hold on;
   end
   
 end
       
               
   


    
        